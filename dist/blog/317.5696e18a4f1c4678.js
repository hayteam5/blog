"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[317],{7317:(ot,f,l)=>{l.r(f),l.d(f,{AdminModule:()=>et});var a=l(6895),u=l(5139),t=l(8274),d=l(6331),Z=l(7579);let c=(()=>{class n{constructor(){this.alert$=new Z.x}success(e){this.alert$.next({type:"success",text:e})}warning(e){this.alert$.next({type:"warning",text:e})}danger(e){this.alert$.next({type:"danger",text:e})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();const x=function(n,r,e){return{"alert-success":n,"alert-warning":r,"alert-danger":e}};function C(n,r){if(1&n&&(t.TgZ(0,"div",1)(1,"div",2)(2,"p"),t._uU(3),t.qZA()()()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngClass",t.kEZ(2,x,"success"===e.type,"warning"===e.type,"danger"===e.type)),t.xp6(2),t.Oqu(e.text)}}let b=(()=>{class n{constructor(e){this.alertService=e,this.delay=5e3,this.text="",this.type="success"}ngOnInit(){this.aSub=this.alertService.alert$.subscribe(e=>{this.text=e.text,this.type=e.type;const o=setTimeout(()=>{clearTimeout(o),this.text=""},this.delay)})}ngOnDestroy(){this.aSub&&this.aSub.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-alert"]],inputs:{delay:"delay"},decls:1,vars:1,consts:[["class","alert-wrap",4,"ngIf"],[1,"alert-wrap"],[1,"alert",3,"ngClass"]],template:function(e,o){1&e&&t.YNc(0,C,4,6,"div",0),2&e&&t.Q6J("ngIf",o.text)},dependencies:[a.mk,a.O5],styles:[".alert-wrap[_ngcontent-%COMP%]{position:fixed;top:50px;right:40px;max-width:200px}"]}),n})();const A=function(){return["/admin","dashboard"]},T=function(){return["/admin","create"]};function q(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"ul")(1,"li",4)(2,"a",5),t._uU(3,"Accueil"),t.qZA()(),t.TgZ(4,"li",4)(5,"a",5),t._uU(6,"Cr\xe9er"),t.qZA()(),t.TgZ(7,"li")(8,"a",6),t.NdJ("click",function(s){t.CHM(e);const m=t.oxw();return t.KtG(m.logout(s))}),t._uU(9,"Sortir"),t.qZA()()()}2&n&&(t.xp6(2),t.Q6J("routerLink",t.DdM(2,A)),t.xp6(3),t.Q6J("routerLink",t.DdM(3,T)))}let y=(()=>{class n{constructor(e,o){this.router=e,this.authService=o}ngOnInit(){}logout(e){e.preventDefault(),this.authService.logout(),this.router.navigate(["/admin","login"])}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.F0),t.Y36(d.e))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-admin-layout"]],decls:8,vars:1,consts:[[1,"navbar","bg-primary"],["routerLink","/"],[4,"ngIf"],[1,"container"],["routerLinkActive","active"],[3,"routerLink"],["href","#",3,"click"]],template:function(e,o){1&e&&(t._UZ(0,"app-alert"),t.TgZ(1,"nav",0)(2,"h1")(3,"a",1),t._uU(4,"Angular Blog [ Administrateur ]"),t.qZA()(),t.YNc(5,q,10,4,"ul",2),t.qZA(),t.TgZ(6,"div",3),t._UZ(7,"router-outlet"),t.qZA()),2&e&&(t.xp6(5),t.Q6J("ngIf",o.authService.isAuthenticated()))},dependencies:[a.O5,u.lC,u.yS,u.Od,b],styles:["form[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}"]}),n})();var i=l(433);function w(n,r){if(1&n&&(t.TgZ(0,"div",10),t._uU(1),t.qZA()),2&n){const e=r.ngIf;t.xp6(1),t.hij(" ",e," ")}}function I(n,r){if(1&n&&(t.TgZ(0,"div",11),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.message," ")}}function P(n,r){1&n&&(t.TgZ(0,"small"),t._uU(1,"Entrez l'adresse email"),t.qZA())}function J(n,r){1&n&&(t.TgZ(0,"small"),t._uU(1,"Email incorrecte"),t.qZA())}function U(n,r){if(1&n&&(t.TgZ(0,"div",12),t.YNc(1,P,2,0,"small",13),t.YNc(2,J,2,0,"small",13),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.form.controls.email.errors?null:e.form.controls.email.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.form.controls.email.errors?null:e.form.controls.email.errors.email)}}function S(n,r){if(1&n&&(t.TgZ(0,"small"),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.AsE("Mot de passe doit avoir ",null==e.form.controls.password.errors?null:e.form.controls.password.errors.minlength.requiredLength," caract\xe8res, vous avez rentr\xe9 ",null==e.form.controls.password.errors?null:e.form.controls.password.errors.minlength.actualLength,". ")}}function L(n,r){1&n&&(t.TgZ(0,"small"),t._uU(1,"Entrez le mot de passe"),t.qZA())}function N(n,r){if(1&n&&(t.TgZ(0,"div",12),t.YNc(1,S,2,2,"small",13),t.YNc(2,L,2,0,"small",13),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.form.controls.password.errors?null:e.form.controls.password.errors.minlength),t.xp6(1),t.Q6J("ngIf",null==e.form.controls.password.errors?null:e.form.controls.password.errors.required)}}const h=function(n){return{invalid:n}};let Y=(()=>{class n{constructor(e,o,s){this.auth=e,this.router=o,this.route=s,this.submitted=!1}ngOnInit(){this.route.queryParams.subscribe(e=>{e.loginAgain?this.message="Veuillez remplir les donn\xe9es de connexion":e.authFailed&&(this.message="La cession est termin\xe9e, merci de vous connecter de nouveau")}),this.form=new i.cw({email:new i.NI("",[i.kI.required,i.kI.email]),password:new i.NI("",[i.kI.required,i.kI.minLength(6)])})}submit(){this.form.invalid||(this.submitted=!0,this.auth.login({email:this.form.value.email,password:this.form.value.password}).subscribe(()=>{this.form.reset(),this.router.navigate(["/admin","dashboard"]),this.submitted=!1},()=>{this.submitted=!1}))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.e),t.Y36(u.F0),t.Y36(u.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-login-page"]],decls:18,vars:14,consts:[[1,"card",3,"formGroup","ngSubmit"],["class","alert alert-danger",4,"ngIf"],["class","alert alert-info",4,"ngIf"],[1,"form-control",3,"ngClass"],["for","email"],["id","email","type","email","formControlName","email"],["class","validation",4,"ngIf"],["for","password"],["id","password","type","password","formControlName","password"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"alert","alert-danger"],[1,"alert","alert-info"],[1,"validation"],[4,"ngIf"]],template:function(e,o){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return o.submit()}),t.TgZ(1,"h2"),t._uU(2,"Entrer dans l'espace admin"),t.qZA(),t.YNc(3,w,2,1,"div",1),t.ALo(4,"async"),t.YNc(5,I,2,1,"div",2),t.TgZ(6,"div",3)(7,"label",4),t._uU(8,"Email:"),t.qZA(),t._UZ(9,"input",5),t.YNc(10,U,3,2,"div",6),t.qZA(),t.TgZ(11,"div",3)(12,"label",7),t._uU(13,"Mot de passe:"),t.qZA(),t._UZ(14,"input",8),t.YNc(15,N,3,2,"div",6),t.qZA(),t.TgZ(16,"button",9),t._uU(17,"Entrer"),t.qZA()()),2&e&&(t.Q6J("formGroup",o.form),t.xp6(3),t.Q6J("ngIf",t.lcZ(4,8,o.auth.error$)),t.xp6(2),t.Q6J("ngIf",o.message),t.xp6(1),t.Q6J("ngClass",t.VKq(10,h,o.form.controls.email.touched&&o.form.controls.email.invalid)),t.xp6(4),t.Q6J("ngIf",o.form.controls.email.touched&&o.form.controls.email.invalid),t.xp6(1),t.Q6J("ngClass",t.VKq(12,h,o.form.controls.password.touched&&o.form.controls.password.invalid)),t.xp6(4),t.Q6J("ngIf",o.form.controls.password.touched&&o.form.controls.password.invalid),t.xp6(1),t.Q6J("disabled",o.form.invalid||o.submitted))},dependencies:[a.mk,a.O5,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u,a.Ov]}),n})();var g=l(6750);let Q=(()=>{class n{transform(e,o=""){return o.trim()?e.filter(s=>s.title.toLowerCase().includes(o.toLowerCase())):e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=t.Yjl({name:"searchPosts",type:n,pure:!0}),n})();const E=function(n){return["/admin","post",n,"edit"]};function O(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"date"),t.qZA(),t.TgZ(10,"td")(11,"button",5),t._uU(12,"Modifier "),t.qZA(),t.TgZ(13,"a",6),t.NdJ("click",function(){const m=t.CHM(e).$implicit,nt=t.oxw(2);return t.KtG(nt.remove(m.id))}),t._uU(14,"Supprimer"),t.qZA()()()}if(2&n){const e=r.$implicit,o=r.index;t.xp6(2),t.Oqu(o+1),t.xp6(2),t.Oqu(e.author),t.xp6(2),t.Oqu(e.title),t.xp6(2),t.Oqu(t.gM2(9,5,e.date,"medium",void 0,"fr")),t.xp6(3),t.Q6J("routerLink",t.VKq(10,E,e.id))}}function M(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"div",2)(2,"input",3),t.NdJ("ngModelChange",function(s){t.CHM(e);const m=t.oxw();return t.KtG(m.searchStr=s)}),t.qZA()(),t.TgZ(3,"table")(4,"thead")(5,"tr")(6,"th"),t._uU(7,"#"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Auteur"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Titre"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"Date"),t.qZA(),t.TgZ(14,"th"),t._uU(15,"Action"),t.qZA()()(),t.TgZ(16,"tbody"),t.YNc(17,O,15,12,"tr",4),t.ALo(18,"searchPosts"),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngModel",e.searchStr),t.xp6(15),t.Q6J("ngForOf",t.xi3(18,2,e.posts,e.searchStr))}}function F(n,r){1&n&&(t.TgZ(0,"p",7),t._uU(1,"Chargement en cours..."),t.qZA())}let k=(()=>{class n{constructor(e,o){this.postService=e,this.alert=o,this.posts=[],this.searchStr=""}ngOnInit(){this.pSub=this.postService.getAll().subscribe(e=>{this.posts=e})}ngOnDestroy(){this.pSub&&this.pSub.unsubscribe(),this.dSub&&this.dSub.unsubscribe()}remove(e){this.postService.remove(e).subscribe(()=>{this.posts=this.posts.filter(o=>o.id!==e),this.alert.danger("Le poste a \xe9t\xe9 supprim\xe9")})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(g.P),t.Y36(c))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-dashboard-page"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loading",""],[1,"form-control"],["type","text","placeholder","Chercher un poste...",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],[1,"btn","btn-link","open",3,"routerLink"],[3,"click"],[1,"text-center"]],template:function(e,o){if(1&e&&(t.YNc(0,M,19,5,"div",0),t.YNc(1,F,2,0,"ng-template",null,1,t.W1O)),2&e){const s=t.MAs(2);t.Q6J("ngIf",o.posts.length)("ngIfElse",s)}},dependencies:[a.sg,a.O5,i.Fj,i.JJ,i.On,u.rH,a.uU,Q],styles:[".open[_ngcontent-%COMP%]{margin-right:10px}"]}),n})();var _=l(8155);function D(n,r){1&n&&(t.TgZ(0,"small"),t._uU(1,"Entrez le titre du poste"),t.qZA())}function G(n,r){if(1&n&&(t.TgZ(0,"div",10),t.YNc(1,D,2,0,"small",11),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.form.controls.title.errors?null:e.form.controls.title.errors.required)}}function z(n,r){1&n&&(t.TgZ(0,"small"),t._uU(1,"Entrez l'auteur du poste"),t.qZA())}function K(n,r){if(1&n&&(t.TgZ(0,"div",10),t.YNc(1,z,2,0,"small",11),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.form.controls.author.errors?null:e.form.controls.author.errors.required)}}const v=function(n){return{invalid:n}};let j=(()=>{class n{constructor(e,o){this.postService=e,this.alert=o}ngOnInit(){this.form=new i.cw({title:new i.NI(null,i.kI.required),text:new i.NI(null,i.kI.required),author:new i.NI(null,i.kI.required)})}submit(){if(!this.form.invalid){const e={title:this.form.value.title,text:this.form.value.text,author:this.form.value.author,date:new Date};this.postService.create(e).subscribe(()=>{this.form.reset(),this.alert.success("Le post a \xe9t\xe9 cr\xe9\xe9")}),console.log(e)}}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(g.P),t.Y36(c))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-create-page"]],decls:19,vars:10,consts:[[3,"formGroup","ngSubmit"],[1,"form-control",3,"ngClass"],["for","title"],["id","title","type","text","formControlName","title"],["class","validation",4,"ngIf"],[1,"form-control"],["formControlName","text"],["for","author"],["id","author","type","text","formControlName","author"],["type","submit",1,"btn-dark","btn","btn-block",3,"disabled"],[1,"validation"],[4,"ngIf"]],template:function(e,o){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return o.submit()}),t.TgZ(1,"h1"),t._uU(2,"Creation de nouveau poste"),t.qZA(),t.TgZ(3,"div",1)(4,"label",2),t._uU(5,"Titre du poste:"),t.qZA(),t._UZ(6,"input",3),t.YNc(7,G,2,1,"div",4),t.qZA(),t.TgZ(8,"div",5)(9,"label"),t._uU(10,"Text du poste:"),t.qZA(),t._UZ(11,"quill-editor",6),t.qZA(),t.TgZ(12,"div",1)(13,"label",7),t._uU(14,"Auteur:"),t.qZA(),t._UZ(15,"input",8),t.YNc(16,K,2,1,"div",4),t.qZA(),t.TgZ(17,"button",9),t._uU(18,"Cr\xe9er un poste"),t.qZA()()),2&e&&(t.Q6J("formGroup",o.form),t.xp6(3),t.Q6J("ngClass",t.VKq(6,v,o.form.controls.title.touched&&o.form.controls.title.invalid)),t.xp6(4),t.Q6J("ngIf",o.form.controls.title.touched&&o.form.controls.title.invalid),t.xp6(5),t.Q6J("ngClass",t.VKq(8,v,o.form.controls.author.touched&&o.form.controls.author.invalid)),t.xp6(4),t.Q6J("ngIf",o.form.controls.title.touched&&o.form.controls.title.invalid),t.xp6(1),t.Q6J("disabled",o.form.invalid))},dependencies:[a.mk,a.O5,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u,_.g6],styles:["form[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}"]}),n})();var $=l(3900);function V(n,r){1&n&&(t.TgZ(0,"small"),t._uU(1,"Entrez le titre du poste"),t.qZA())}function X(n,r){if(1&n&&(t.TgZ(0,"div",10),t.YNc(1,V,2,0,"small",11),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",null==e.form.controls.title.errors?null:e.form.controls.title.errors.required)}}const B=function(n){return{invalid:n}};function H(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"form",2),t.NdJ("ngSubmit",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.submit())}),t.TgZ(2,"div",3)(3,"label",4),t._uU(4,"Titre du poste:"),t.qZA(),t._UZ(5,"input",5),t.YNc(6,X,2,1,"div",6),t.qZA(),t.TgZ(7,"div",7),t._UZ(8,"quill-editor",8),t.qZA(),t.TgZ(9,"button",9),t._uU(10,"Modifier"),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(1),t.Q6J("ngClass",t.VKq(4,B,e.form.controls.title.touched&&e.form.controls.title.invalid)),t.xp6(4),t.Q6J("ngIf",e.form.controls.title.touched&&e.form.controls.title.invalid),t.xp6(3),t.Q6J("disabled",e.form.invalid&&e.submitted)}}function W(n,r){1&n&&(t.TgZ(0,"p",12),t._uU(1,"Chargement en cours..."),t.qZA())}let R=(()=>{class n{constructor(e,o,s){this.route=e,this.postService=o,this.alert=s,this.submitted=!1}ngOnInit(){this.route.params.pipe((0,$.w)(e=>this.postService.getById(e.id))).subscribe(e=>{this.post=e,this.form=new i.cw({title:new i.NI(e.title,i.kI.required),text:new i.NI(e.text,i.kI.required)})})}submit(){this.form?.invalid||(this.submitted=!0,this.uSub=this.postService.update({...this.post,title:this.form.value.title,text:this.form.value.text}).subscribe(()=>{this.alert.warning("Le poste a \xe9t\xe9 modifi\xe9"),this.submitted=!1}))}ngOnDestroy(){this.uSub&&this.uSub.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.gz),t.Y36(g.P),t.Y36(c))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-edit-page"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loading",""],[3,"formGroup","ngSubmit"],[1,"form-control",3,"ngClass"],["for","title"],["id","title","type","text","formControlName","title"],["class","validation",4,"ngIf"],[1,"form-control"],["formControlName","text"],["type","submit",1,"btn-primary","btn",3,"disabled"],[1,"validation"],[4,"ngIf"],[1,"text-center"]],template:function(e,o){if(1&e&&(t.YNc(0,H,11,6,"div",0),t.YNc(1,W,2,0,"ng-template",null,1,t.W1O)),2&e){const s=t.MAs(2);t.Q6J("ngIf",o.form)("ngIfElse",s)}},dependencies:[a.mk,a.O5,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u,_.g6]}),n})();var tt=l(4466);let p=(()=>{class n{constructor(e,o){this.auth=e,this.router=o}canActivate(e,o){return!!this.auth.isAuthenticated()||(this.auth.logout(),this.router.navigate(["/admin","login"],{queryParams:{loginAgain:!0}}),!1)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(d.e),t.LFG(u.F0))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})(),et=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[p,c],imports:[a.ez,i.u5,i.UX,tt.m,u.Bz.forChild([{path:"",component:y,children:[{path:"",redirectTo:"/admin/login",pathMatch:"full"},{path:"login",component:Y},{path:"dashboard",component:k,canActivate:[p]},{path:"create",component:j,canActivate:[p]},{path:"post/:id/edit",component:R,canActivate:[p]}]}]),u.Bz]}),n})()}}]);